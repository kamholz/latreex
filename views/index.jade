extends base

append js
  script(type='text/javascript')
    var basepath = '#{basepath}';
    $(document).ready(function () {
      $('#preview').click(function () {
        var div = $('#previewImage');
        div.html('Loading preview...');
        $.post(basepath+'png', $('#form').serializeArray(), function (data) {
          div.html('');
          div.append($("<img />").attr('src', basepath+'png/'+data.name));
        });
      });
    
      $('#latex').click(function () { downloadFile('tex') });
      $('#pdf').click(function () { downloadFile('pdf') });        
    });
    
    function downloadFile(ext) {
      $.post(basepath+ext, $('#form').serializeArray(), function (data) {
        window.location.pathname = basepath+ext+'/'+data.name;
      });
    }

block body
  h1 Language Family Tree Maker

  form#form(method='post',action='/')

    div.rowform
      ul
        li
          label.left Space between sibling nodes:
          input(type='text',name='treesep',tabindex=2,value='4ex',size=6,maxlength=6)
        li
          label.left Parent to daughter length:
          input(type='text',name='levelsep',tabindex=3,value='2cm',size=6,maxlength=6)
        li
          label.left Maximum label width:
          input(type='text',name='LFTwidth',tabindex=4,value='15ex',size=6,maxlength=6)
        li
          label.left Cushion aroubnd labels:
          input(type='text',name='LFTsep',tabindex=5,value='4pt',size=6,maxlength=6)
        li
          label.left Line thickness:
          input(type='text',name='linewidth',tabindex=6,value='0.3pt',size=6,maxlength=6)
    
    div.rowform
      ul
        li Style:
        li
          input(type='radio',name='style',value='flat',tabindex=7)
          label Flat
        li  
          input(type='radio',name='style',value='nonflat',checked='checked',tabindex=8)
          label Nonflat
        li.spaced Font:
        li
          input(type='radio',name='font',value='sf',checked='checked',tabindex=9)
          label Helvetica
        li
          input(type='radio',name='font',value='rm',tabindex=10)
          label Times
        li
          input(type='radio',name='font',value='tt',tabindex=11)
          label Courier

    div.rowform
      ul
        li Direction:
        li
          input(type='radio',name='orient',value='D',checked='checked',tabindex=12)
          label Top to bottom
        li
          input(type='radio',name='orient',value='R',tabindex=13)
          label Left to right
        li
          input(type='radio',name='orient',value='L',tabindex=14)
          label Right to left
        li
          input(type='radio',name='orient',value='U',tabindex=15)
          label Bottom to top
        
    textarea(name="tree",tabindex=1,rows=18,cols=40)
      | Proto-Indo-European~
      | -Balto-Slavic~
      | --Baltic
      | --Slavic
      | ---Russian
      | ---Polish
      | -Germanic
      | --English
      | --German
      | --Dutch
      | --Norwegian
      | -Albanian
      | -.
      | --Italic
      | --Celtic
      | -Greek
      | -Anatolian
  
  div.clearfix
    button#preview Preview Tree
    button#latex Download LaTeX source
    button#pdf Download PDF
  
  #previewImage
